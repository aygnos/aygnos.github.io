<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title> Akagi201 &middot; Akagi201 </title>

  
  <link rel="stylesheet" href="http://akagi201.github.io/css/poole.css">
  <link rel="stylesheet" href="http://akagi201.github.io/css/syntax.css">
  <link rel="stylesheet" href="http://akagi201.github.io/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.ico">

  
  <link href="http://akagi201.github.io/index.xml" rel="alternate" type="application/rss+xml" title="Akagi201" />
</head>

<body>

<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <img src="http://www.gravatar.com/avatar/fe6efcdd159a897e3937d132538129bb?s=200" alt="gravatar">
      <h1>Akagi201</h1>
      <p class="lead">
      The quieter, the more!
      </p>
    </div>

    <ul class="sidebar-nav">
      <li><a href="/">Home</a> </li>
      
      <li><a href="http://akagi201.github.io/blog">Blog</a> </li>
      
      <li><a href="http://akagi201.github.io/tool">Tool</a> </li>
      
      <li><a href="http://akagi201.github.io/book">Book</a> </li>
      
      <li><a href="http://akagi201.github.io/talk">Talk</a> </li>
      
      <li><a href="http://akagi201.github.io/project">Project</a> </li>
      
      <li><a href="http://akagi201.github.io/about">About</a> </li>
      
    </ul>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item"><a href="https://github.com/Akagi201">GitHub</a></li>
      
      <li class="sidebar-nav-item"><a href="https://plus.google.com/&#43;BobLiuAkagi201">Google+</a></li>
      
      
      
    </ul>

    <p>Copyright &copy; 2015 <a href="http://akagi201.github.io/license">License</a><br/>
      Powered by <a href="http://hugo.spf13.com">Hugo</a> and <a href="https://github.com/spf13/hyde">Hyde</a></p>
  </div>
</div>


    <div class="content container">
<div class="posts">

      
  <div class="post">
    <h1 class="post-title">
      <a href="http://akagi201.github.io/blog/stream-encoder/">
        Stream Encoder
      </a>
    </h1>

    <span class="post-date">Wed, Jan 14, 2015</span>

    

<h2 id="toc_0">OBS</h2>

<ul>
<li><a href="https://github.com/jp9000/obs-studio">https://github.com/jp9000/obs-studio</a></li>
<li>开发前说明: <a href="https://obsproject.com/forum/threads/getting-started-with-obs-development.21326/">https://obsproject.com/forum/threads/getting-started-with-obs-development.21326/</a></li>
<li>文档: <a href="http://jp9000.github.io/OBS/">http://jp9000.github.io/OBS/</a></li>
<li>OBS core: libobs, OBS UI: obs, core跟ui是独立的.</li>
<li>OBS core plugins: plugins</li>
<li>IRC: #obsproject on Freenode, #obs-dev on Quakenet</li>
<li>settings estimator: <a href="https://obsproject.com/estimator">https://obsproject.com/estimator</a></li>
<li></li>
</ul>

<h2 id="toc_1">BLE</h2>

<ul>
<li><a href="https://github.com/wenjiegit/Bull-Live-Encoder">https://github.com/wenjiegit/Bull-Live-Encoder</a></li>
</ul>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://akagi201.github.io/blog/learning-rtp/">
        Learning RTP
      </a>
    </h1>

    <span class="post-date">Mon, Dec 15, 2014</span>

    

<p><a href="https://www.mindmup.com/map/b/akagi201/learning-rtp.mup" data-role="mindmup-embed" title="learning-rtp" data-width="90%" data-height="500" data-style="border:1px solid black;margin-bottom:5px;">learning-rtp on MindMup</a>
<script async src="https://www.mindmup.com/external-embed.js"></script></p>

<p><code>RTP</code>(Real-time Transport Protocol)是用于Internet上针对多媒体数据流的一种传输协议. <code>RTP</code>被定义为在一对一或一对多的传输情况下工作, 其目的是提供时间信息和实现流同步. <code>RTP</code>通常使用<code>UDP</code>来传送数据, 但<code>RTP</code>也可以在<code>TCP</code>或<code>ATM</code>等其他协议之上工作.</p>

<p><code>RTP</code>本身并没有提供按时发送机制或其他服务质量(QoS)保证, 它依赖于底层服务去实现这一过程. <code>RTP</code>并不保证传送或防止无序传送, 也不确定底层网络的可靠性.</p>

<h2 id="toc_0">book</h2>

<ul>
<li><a href="https://www.safaribooksonline.com/library/view/rtp-audio-and/0672322498/">https://www.safaribooksonline.com/library/view/rtp-audio-and/0672322498/</a></li>
<li><a href="http://www.amazon.com/RTP-Audio-Video-Internet-paperback/dp/0321833627">http://www.amazon.com/RTP-Audio-Video-Internet-paperback/dp/0321833627</a></li>
</ul>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://akagi201.github.io/blog/learning-curl/">
        Learning cURL
      </a>
    </h1>

    <span class="post-date">Tue, Dec 9, 2014</span>

    

<p><a href="https://www.mindmup.com/map/b/akagi201/learning-curl.mup" data-role="mindmup-embed" title="learning-gtest" data-width="90%" data-height="500" data-style="border:1px solid black;margin-bottom:5px;">learning-gtest on MindMup</a>
<script async src="https://www.mindmup.com/external-embed.js"></script></p>

<p>cURL全称是&rdquo;Client for URLs&rdquo;, 即URL客户端.</p>

<p>是<a href="https://github.com/bagder">Daniel Stenberg</a>的一个个人项目, 就放在个人的一个二级域名<a href="http://curl.haxx.se/">http://curl.haxx.se/</a>下, 所以有的地方略显粗糙也可以理解了.</p>

<p>项目历史应该比较久远了, 文档全是用的<code>manpage</code>写的, 不用到处找了, 直接<code>man</code>就可以了.</p>

<p><code>curl</code>的<code>repo</code>由两部分组成, <code>curl</code>命令行跟<code>libcurl</code>, 其中复杂的东西都在<code>libcurl</code>中了.</p>

<h2 id="toc_0">源码结构</h2>

<ul>
<li><code>curl</code>命令行的源码在<code>src/</code>, 入口在<code>tool_main.c</code>.</li>
<li><code>libcurl</code>的源码在<code>lib/</code>.</li>
<li><code>API example</code>的源码在<code>docs/examples</code>下.</li>
</ul>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://akagi201.github.io/blog/learning-gtest/">
        Learning Google C&#43;&#43; Testing Framework
      </a>
    </h1>

    <span class="post-date">Thu, Dec 4, 2014</span>

    <p><a href="https://www.mindmup.com/map/b/akagi201/learning-gtest.mup" data-role="mindmup-embed" title="learning-gtest" data-width="90%" data-height="500" data-style="border:1px solid black;margin-bottom:5px;">learning-gtest on MindMup</a>
<script async src="https://www.mindmup.com/external-embed.js"></script></p>

<p>最近接触不少有趣的小项目, 让我重拾C语言的乐趣了. 现在移动和web发展非常块, web领域技术的发展, 也推进了底层技术的发展. <code>clib</code>就让我对<code>js</code>跟<code>node</code>这帮人的印象大大改观.</p>

<p>跟着牛人的脚本慢慢前进是不会错的. 选择了<code>CLion</code>, 导致选择了<code>CMake</code>, 又由<code>CMake</code>跟<code>CLion</code>选择了<code>GTest</code>. 学习下来发现都是好东西.</p>

<p><code>Google C++ Testing Framework</code>简称<code>GTest</code>, 跟<code>CMake</code>集成的非常好, 而且他本身就是用<code>CMake</code>编译的, 作为一个转向<code>CMake</code>开发者来说, 这是极赞的.</p>

<p><code>GTest</code>文档相应比较少, 对于新手来说可能有点曲线, 我写了几个集成<code>Makefile</code>跟<code>CMake</code>的例子, 可以看看: <a href="https://github.com/Akagi201/learning-gtest">https://github.com/Akagi201/learning-gtest</a></p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://akagi201.github.io/blog/learning-libuv/">
        Learning Libuv
      </a>
    </h1>

    <span class="post-date">Thu, Nov 13, 2014</span>

    <p><a href="https://www.mindmup.com/map/b/akagi201/learning-libuv.mup" data-role="mindmup-embed" title="learning-libuv" data-width="90%" data-height="500" data-style="border:1px solid black;margin-bottom:5px;">learning-libuv on MindMup</a>
<script async src="https://www.mindmup.com/external-embed.js"></script></p>

<p>想研究libuv很久了, 一直没有用他的机会, 这次项目中有个多进程管理的地方, 正纠结怎么操作麻烦的信号量时, 想起libuv也可以完成这件事, 所以, 赶紧用起来. 不用白不用.</p>

<p>Lua在嵌入式领域大有可以, 可以编译成一个liblua.a的库静态连接到C程序, 还有很多丰富的工具, 本身语言有非常小巧, 以后还是多用lua写写, 方便移植啊. 多平台各种差异, 搞死人啊.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://akagi201.github.io/blog/learning-ucos/">
        Learning uC/OS
      </a>
    </h1>

    <span class="post-date">Thu, Nov 13, 2014</span>

    <p><a href="https://www.mindmup.com/map/b/akagi201/learning-ucos.mup" data-role="mindmup-embed" title="learning-ucos" data-width="90%" data-height="500" data-style="border:1px solid black;margin-bottom:5px;">learning-ucos on MindMup</a>
<script async src="https://www.mindmup.com/external-embed.js"></script></p>

<p>最近比较粗略的学习了一下uC/OS-II的系统, 感觉设计上中规中矩吧, 很多类似的结构, 应该可以设计得更精简些的, 不过, 在单片机系统上用的还是蛮多的. 其中任务就绪表跟内存管理部分, 还需要有空再详细看看.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://akagi201.github.io/blog/about-blog/">
        About Blog
      </a>
    </h1>

    <span class="post-date">Tue, Oct 21, 2014</span>

    

<h2 id="toc_0">TODO</h2>

<ul>
<li>在slide部分上方显示我的头像.</li>
<li>在手机跟PC上显示slide部分更优雅一点.</li>
<li>中英文两个版本切换.</li>
<li>不同分类用不同的样式.</li>
</ul>

<h2 id="toc_1">Categories</h2>

<ul>
<li>blog, tool, book, talk, project</li>
</ul>

<h2 id="toc_2">Tags</h2>

<ul>
<li>openwrt, kernel, wifi, hardware, macosx, golang, algorithm, git, protocol, security</li>
</ul>

<h2 id="toc_3">Markdown Contents</h2>

<ul>
<li><a href="https://github.com/Akagi201/akblog">https://github.com/Akagi201/akblog</a></li>
</ul>

<h2 id="toc_4">Static Pages</h2>

<ul>
<li><a href="https://github.com/Akagi201/akagi201.github.io">https://github.com/Akagi201/akagi201.github.io</a></li>
</ul>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://akagi201.github.io/blog/learning-cmake/">
        Learning CMake
      </a>
    </h1>

    <span class="post-date">Sun, Oct 19, 2014</span>

    

<p><a href="https://www.mindmup.com/map/b/akagi201/learning%20cmake.mup" data-role="mindmup-embed" title="learning cmake" data-width="90%" data-height="500" data-style="border:1px solid black;margin-bottom:5px;">learning cmake on MindMup</a>
<script async src="https://www.mindmup.com/external-embed.js"></script></p>

<p>为了更好的掌握CLion, 最近把CMake Practice看完, 并练习了一下. 完成之后发现内容很少. 老的autotools也是要掌握的, openwrt上编译很多项目还是要用到他.</p>

<h2 id="toc_0">Github Repo</h2>

<ul>
<li><a href="https://github.com/Akagi201/learning-cmake">https://github.com/Akagi201/learning-cmake</a></li>
</ul>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://akagi201.github.io/blog/learning-ffmpeg/">
        Learning FFmpeg
      </a>
    </h1>

    <span class="post-date">Fri, Oct 10, 2014</span>

    <p><a href="https://www.mindmup.com/map/b/akagi201/learning%20ffmpeg.mup" data-role="mindmup-embed" title="learning ffmpeg" data-width="90%" data-height="500" data-style="border:1px solid black;margin-bottom:5px;">learning ffmpeg on MindMup</a>
<script async src="https://www.mindmup.com/external-embed.js"></script></p>

<p>我自己购买了mindmup gold的账号, 有钱淫欢迎投资我啊!!</p>

<p>发现个ffmpeg领域的大牛, 他已经在读博士了, 天朝这样做学术的人还是值得赞赏的, ffmpeg中文资料必看: <a href="http://blog.csdn.net/leixiaohua1020">http://blog.csdn.net/leixiaohua1020</a></p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://akagi201.github.io/blog/learning-makefile/">
        Learning Makefile
      </a>
    </h1>

    <span class="post-date">Thu, Jun 5, 2014</span>

    

<p><img src="http://akagi201.qiniudn.com/learning-makefile.png" alt="learning-makefile" />
</p>

<p>系统的学习了一下Makefile, 隐含规则部分没有详细看, 实际使用过程中也不会依靠这个东西的.</p>

<h2 id="toc_0">参考资料</h2>

<ol>
<li>跟我一起学Makefile</li>
<li>GNU Makefile Reference: <a href="http://www.gnu.org/software/make/manual/make.html">http://www.gnu.org/software/make/manual/make.html</a></li>
<li>另一个淘宝前辈的总结(简单向, 我的更偏向深入一些): <a href="http://kenwublog.com/arrange-makefile-knowledges">http://kenwublog.com/arrange-makefile-knowledges</a></li>
<li>调试makefile: <a href="http://coolshell.cn/articles/3790.html">http://coolshell.cn/articles/3790.html</a></li>
</ol>

<h2 id="toc_1">偶遇的好东西</h2>

<p>自主学习的一个好处就是, 在研究的过程中会发现很多好玩的东西.</p>

<ul>
<li>All Cheat Sheets in one page: <a href="http://www.cheat-sheets.org/">http://www.cheat-sheets.org/</a></li>
<li>一个更加牛逼的东西, 在任何软件界面下按住command键不放即可显示快捷键 <a href="http://www.mediaatelier.com/CheatSheet/">http://www.mediaatelier.com/CheatSheet/</a></li>
<li>PopClip, 一个效率工具吧.</li>
</ul>

<h2 id="toc_2">Mindmap</h2>

<ul>
<li>由于记录的notes太多了, 不能使用免费的存储服务, open放到google drive了 <a href="https://drive.google.com/file/d/0BzJcP7mynkO5UWhnVjlmd2tWM1E/edit?usp=sharing">https://drive.google.com/file/d/0BzJcP7mynkO5UWhnVjlmd2tWM1E/edit?usp=sharing</a></li>
</ul>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://akagi201.github.io/blog/root-nook-simple-touch/">
        Root Nook Simple Touch
      </a>
    </h1>

    <span class="post-date">Sat, May 31, 2014</span>

    

<p><img src="http://akagi201.qiniudn.com/nookmanager-success.jpg" alt="nookmanager-success" />
</p>

<p>今天断网了大半天, 然后玩了一会Calibre, 翻出了我的Nook3, 刚好利用这个假期打算把他root掉.</p>

<h2 id="toc_0">使用NookManager进行root</h2>

<ol>
<li>固件升级到官方1.2.1(我的原来是1.1.5的, 如果不升级那么root时会ModManager会安装失败)</li>
<li>下载NookManager.img.</li>
<li>使用dd命令将NookManager.img写入一个空的sd卡中.(我用Mac OS X系统, linux下类似, win下用相应工具)</li>
</ol>

<pre><code>akagi201@akrmbp ~ $ ls /dev/disk*
/dev/disk0   /dev/disk0s1 /dev/disk0s2 /dev/disk0s3 /dev/disk1   /dev/disk1s1
akagi201@akrmbp ~ $ sudo diskutil umount force /dev/disk1s1
Volume (null) on disk1s1 force-unmounted
akagi201@akrmbp ~ $ sudo dd if=/Users/akagi201/Downloads/NookManager.img of=/dev/disk1 bs=1m
64+0 records in
64+0 records out
67108864 bytes transferred in 49.549986 secs (1354367 bytes/sec)
</code></pre>

<ol>
<li>关掉Nook的电源, 插入sd卡, 然后开机, 会显示15秒的NookManager的信息.</li>
</ol>

<p><img src="http://akagi201.qiniudn.com/nookmanager-start.jpg" alt="nookmanager-start" />
</p>

<ol>
<li>选择&rdquo;No, continue without wireless&rdquo;, 选yes需要刷机之前设备有连过你附近的ap, 才能验证通过.(这个其实可以改进啦)</li>
</ol>

<p><img src="http://akagi201.qiniudn.com/nookmanager-wifi.jpg" alt="nookmanager-wifi" />
</p>

<ol>
<li>使用NookManager做一次备份! Rescue -&gt; Backup -&gt; Format remaining space on SD card -&gt; Create backup. (需要花费15~45分钟, 最终备份文件大小是几百M)</li>
</ol>

<p><img src="http://akagi201.qiniudn.com/nookmanager-backup.jpg" alt="nookmanager-backup" />
</p>

<ol>
<li><p>使用USB线连接电脑和nook, 拷贝NookBackup分区下的backup.full.gz和backup.full.md5到电脑, 最好上传到网盘备份好.</p></li>

<li><p>Root! 备份之后, Back -&gt; Back -&gt; Main Menu -&gt; Root -&gt; Root my device (然后看到全是成功, 如果不成功说明你用其他方法root过或者没有升级到官方的1.2.1)</p></li>
</ol>

<p><img src="http://akagi201.qiniudn.com/nookmanager-root.jpg" alt="nookmanager-root" />
</p>

<p><img src="http://akagi201.qiniudn.com/nookmanager-success.jpg" alt="nookmanager-success" />
</p>

<ol>
<li>Back -&gt; Exit -&gt; 拔出SD卡 -&gt; 设备自动重启 -&gt; 选择Relaunch. 搞定.</li>
</ol>

<h2 id="toc_1">Refs</h2>

<ul>
<li><a href="http://forum.xda-developers.com/showthread.php?t=2040351">http://forum.xda-developers.com/showthread.php?t=2040351</a></li>
<li><a href="http://nookdevs.com/Nook_Simple_Touch/Rooting">http://nookdevs.com/Nook_Simple_Touch/Rooting</a></li>
</ul>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://akagi201.github.io/blog/wireless-penetration/">
        Wireless Penetration
      </a>
    </h1>

    <span class="post-date">Wed, May 28, 2014</span>

    

<p><img src="http://akagi201.qiniudn.com/wireless-penetration.png" alt="wireless-penetration" />
</p>

<p>之前<a href="http://www.zhihu.com/people/Akagi201">知乎</a>上有人私信我, 问我无线安全都需要了解哪些东西, 如何去学, 当时没有给他一个好的答案, 最近在研究无线安全攻防方面的东西, 刚好看到一个不错的东西整理一下框架, 然后, 慢慢补充细节.</p>

<p><a href="https://www.mindmup.com/map/a142782190c86701310d3e06c80965547f" data-role="mindmup-embed" title="Wireless Penetration" data-width="90%" data-height="500" data-style="border:1px solid black;margin-bottom:5px;">Wireless Penetration on MindMup</a>
<script async src="https://www.mindmup.com/external-embed.js"></script></p>

<h2 id="toc_0">Refs</h2>

<ul>
<li><a href="http://www.wirelessdefence.org">http://www.wirelessdefence.org</a></li>
</ul>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://akagi201.github.io/blog/learning-kernel/">
        Learning Kernel
      </a>
    </h1>

    <span class="post-date">Thu, May 1, 2014</span>

    

<p>我是从大二开始使用linux系统的, 当时除了玩单片机之外, 所有工作完全在linux完成, 克服了种种&rdquo;困难&rdquo;. 不过现在看来自己除了佩服自己当时的热情之外, 就只觉得自己太幼稚了. &ldquo;在正确的时间做正确的事情, 用正确的工具做正确的事情.&rdquo; 就像以前一直很偏爱C语言一样, 一定要写成内核模块, 内核线程&hellip; 现在自己变得更加聪明了.</p>

<p>我大学期间一直没有机会碰linux内核, 只有在大三下的时候, 在实验室玩ARM开发板, 才知道, 原来linux内核做了这么多的工作, 一个hello world能够轻松的运行起来, 背后有多少的东西在默默无闻的工作着.</p>

<p>毕业后我按照自己的规划找了一份嵌入式软件开发的工作. 公司也还算给力, 给了我足够的时间来学习. 我当时是从驱动入手的, 主要看了一本书和一个英文文档, 分别是LDD3和LKMPG. 这本书我前段时间又看了一遍, 觉得这个不适合一个新手看, 难怪我当初看的那么累, 原因有是作者在书内容里无缝地介绍了软件架构, 代码复用等等对于新手来说高级的东西, 这些应该属于软件工程的内容, 这样当然有好处, 但是给人感觉就是复杂, 相比之下国内的书会简单直接很多. 另外LDD3是基于2.6内核的API写的驱动, 已经有大牛移植到linux3.x上面了.</p>

<p>其实, 内核代码发展很快, 差几个版本基本就面目全非了, 所以, 要多看, 多思考, 有整体把握. 这样, 过段时间拿到最新的代码了, 自己也有能力跟踪进去.</p>

<p>最近, 在linux社区上面看了几篇有趣的东西, 在HN上貌似也火了一下, 所以, 分享出来给大家玩下.</p>

<h2 id="toc_0">Eudyptula</h2>

<p>模仿Matasano Crypto Challenge(集中48小时的练习, 培训参与者密码系统如何建立以及如何被攻击), 面向linux内核的一系列编程练习, 任务难度逐渐增加. 一切是从给little@eudyptula-challenge.org发一封邮件说你要加入开始的. 由于实际的内核开发就是通过邮件列表沟通的, 所以, 必须要熟悉邮件工具是必备技能.</p>

<p>PS: 由于我发了邮件他还没回我, 呵呵, 后面等做了几个任务之后再跟大家分享一下.</p>

<h2 id="toc_1">Kernel 101</h2>

<p>这篇文章最近在HN上比较火, 教你从0开始写一个kernel, 当然功能仅仅是打印一行信息而已. 对于新手来说还是比较好的学习材料. 源码就2个文件, 一段汇编主要功能就是跳转到C程序的kmain函数; 一段C代码, 将显存内容清空并赋值为一段字符串.</p>

<p>其中几个关键知识点记录一下:
1. x86的CPU启动后从地址[0xFFFFFFF0]处开始执行, 这个是设计CPU时写死的. 从芯片手册上可以查到. 下面提到的一些地址都是芯片手册中规定统一的, 所以x86架构才能够通用, 各种OS都能安装, 不需要繁琐的移植工作.
2. 启动流程: 上电 -&gt; CPU[0xFFFFFFF0] -&gt; 跳转到内存中BIOS代码 -&gt; 根据BIOS配置将物理设备第一个扇区的代码copy到物理内存的[0x7c00]位置(即boot loader的代码) -&gt; bootloader将内核代码加载到物理内存<a href="x86 CPU宏内核代码起始地址, 也就是后面我们编写的汇编程序的链接地址">0x100000</a>.
3. 汇编代码中使用了一些nasm的伪指令, 所以, um, 看注释就好.
4. 通常的内核开发还需要提供一个根文件系统文件的, 这个简单例子是不包含文件系统的.
5. grub2下添加引导项的方法, 成败在于此, 需要注意你的/boot分区是否是一个独立分区, 如果不是独立分区那么ok, 安装作者的文章搞起; 如果你像我一样安装系统时候将/boot独立一个256M空间的分区, 那么要内核文件位置使用相对/boot相对地址. 另外注意, 要使用msdos2, 否则会失败.</p>

<pre><code>$sudo vim /boot/grub/grub.conf

//在文件中其他引导项下面添加如下
menuentry 'Akagi201 Lovely Kernel' {
    set root='hd0,msdos2'
    multiboot /kernel-7001 ro
}
</code></pre>

<h2 id="toc_2">What my new-born kernel says</h2>

<p>um, 我改了一下颜色, 跟字符内容, 哈哈, 没啥技术含量啦!</p>

<p><img src="http://akagi201.qiniudn.com/akgrub.png" alt="akgrub" />
</p>

<p><img src="http://akagi201.qiniudn.com/akkernel.png" alt="akkernel" />
</p>

<h2 id="toc_3">links</h2>

<ul>
<li>The Linux Kernel Module Programming Guide: <a href="http://tldp.org/LDP/lkmpg/2.6/html/">http://tldp.org/LDP/lkmpg/2.6/html/</a> 看完这个你就能让内核输出hello world啦.</li>
<li>LDD3-examples-3.x: <a href="https://github.com/duxing2007/ldd3-examples-3.x">https://github.com/duxing2007/ldd3-examples-3.x</a> 你应该会注意到不同的branch对应不同的内核版本, 很赞吧!</li>
<li>kernel 101 on HN: <a href="https://news.ycombinator.com/item?id=7588205">https://news.ycombinator.com/item?id=7588205</a> 有人还做了FUSE版本, 作者也要出ARM版本了, 可以关注下, 上面作者有更多的细节解释.</li>
</ul>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://akagi201.github.io/blog/protect-your-privacy-with-pgp/">
        保护你的隐私, 从PGP开始
      </a>
    </h1>

    <span class="post-date">Sat, Mar 29, 2014</span>

    

<p>以前大学还在玩ubuntu的时候, 天天逛ubuntu的中文论坛, 看到这么个家伙, <a href="http://adam8157.info/about">http://adam8157.info/about</a>, 他的about页面一直放了一个<code>My PGP/GPG key ID: 2F39D84D</code>, 我一直不知道是干什么用的, 我还特意到知乎上问了一下, 不过貌似知乎对这么被认为是可google的问题没兴趣(对八卦和吐槽感兴趣?), 没得到满意答案, 今天有个空挡, 还是自己研究下.</p>

<p>PGP(OpenPGP)是一个历史悠久的电子加密和签章系统, 透过public key加密演算法, 保护个人电子资料, 不会在散布过程或存储媒体中被有心者窥视, 破坏或伪装. 不同于一般以CA(Certificate Authority, 认证机构)为基础的签章, 加密系统, PGP是分散式的系统, PGP没有中央的控制或信任机构, 因此不会被政府, 少数机构所控制,入侵. 在这个公权力无法被信任的年代, 我们正需要这样的系统, 保护我们的通讯安全.</p>

<h2 id="toc_0">Web Of Trust</h2>

<p>PGP是透过所谓的web of trust, 建构信任网. 也对于, 透过人际网路, 一对一的交换PGP key(public key), 安全的通讯管道, 建立在人和人之们的信任感上. 相对的, 以CA为基础的系统, 是透过少数集中的组织, 交换public key. 因此, CA容易受政府或少数机构的控制, 而破坏其安全性. 而web of trust则没这样的问题, 没有中央机构可以伪造你的PGP key. PGP的使用者, 透过web of trust确保所使用的 key, 不是政府或第三方所伪造的.</p>

<ul>
<li>Web Of Trust的运作: <a href="http://www.pgpi.org/doc/pgpintro/#p20">http://www.pgpi.org/doc/pgpintro/#p20</a></li>
</ul>

<h2 id="toc_1">伪造Public Key</h2>

<p>CA为基础的系统, Public Key的散布是透过CA对Public Key进行签名. CA会有一份公开的Public Key, 透过使用对应的secret key对某Public Key签名, 由CA保证其正确性. 而使用者, 透过验证通讯对方的Public Key是否有CA的正确签名, 确保使用正确的Public Key. 这样的系统, 建立在对CA的信任, 因此CA必需是公信的第三者. 然而, 事实上没有绝对公信的第三者, 政治力量随时可能入侵CA, 透过CA的Key, 伪造任何人的Public Key. 因此, 像CA这类中央式的系统, 容易受外力影向, 进行大规模隐私侵害, 无法保护通信的自由和隐密. 事实上, 中国某CA运作单位, 就被怀疑有这种<a href="http://blog.nutsfactory.net/2010/02/02/remove-cnnic-cert-on-linux/">可能</a>.</p>

<h2 id="toc_2">PGP工具</h2>

<p>PGP系统的实现, 有两项主要工具, PGP和GPG. PGP是原先的实现, 而GPG则是GNU实现的相容工具, 和PGP相容. 本文介绍GPG的使用.</p>

<h2 id="toc_3">产生PGP Key</h2>

<p>GPG基本上会产生两对key, 一组用来sign(签章), 另一组用来encrypt(加密).  Encryption用途的key, 因为比较常被使用, 因此较容易受攻击. (透过分析加密的样本, 数量愈多, 愈可能分析出原本的key.) 因此, 一般建议定期更换加密用的 key. 然而, 更换key非常麻烦, 必需一一重新和拥有你的key的朋友交换. 因此, 签章用途的key通常是和加密用途的key分开的. 签章用途的key较少使用, 因此较不易被破解, 通常是永久使用. 在你更换新加密用途的key时, 能够使用签章用途的key, 为新的key签名. 因此, 你可以透过email或其它网路的方式散布你加密用途的新key. 收到新key的朋友, 就可以使用你签章用途的key, 验证你的新key.</p>

<p>产生新的PGP key的方法:</p>

<pre><code>## 两种安装方法
#1. brew install gnupg # 命令行和linux完全一样
#2. https://gpgtools.org/ # GUI界面, 其实命令行就够了

akagi201@akrmbp ~ $ gpg --gen-key
gpg (GnuPG) 1.4.16; Copyright (C) 2013 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

gpg: directory `/Users/akagi201/.gnupg' created
gpg: new configuration file `/Users/akagi201/.gnupg/gpg.conf' created
gpg: WARNING: options in `/Users/akagi201/.gnupg/gpg.conf' are not yet active during this run
gpg: keyring `/Users/akagi201/.gnupg/secring.gpg' created
gpg: keyring `/Users/akagi201/.gnupg/pubring.gpg' created
Please select what kind of key you want:
   (1) RSA and RSA (default)
   (2) DSA and Elgamal
   (3) DSA (sign only)
   (4) RSA (sign only)
Your selection? 4
RSA keys may be between 1024 and 4096 bits long.
What keysize do you want? (2048)
Requested keysize is 2048 bits
Please specify how long the key should be valid.
         0 = key does not expire
      &lt;n&gt;  = key expires in n days
      &lt;n&gt;w = key expires in n weeks
      &lt;n&gt;m = key expires in n months
      &lt;n&gt;y = key expires in n years
Key is valid for? (0)
Key does not expire at all
Is this correct? (y/N) y

You need a user ID to identify your key; the software constructs the user ID
from the Real Name, Comment and Email Address in this form:
    &quot;Heinrich Heine (Der Dichter) &lt;heinrichh@duesseldorf.de&gt;&quot;

Real name: Akagi201
Email address: akagi201@gmail.com
Comment: Bob Liu
You selected this USER-ID:
    &quot;Akagi201 (Bob Liu) &lt;akagi201@gmail.com&gt;&quot;

Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? O
You need a Passphrase to protect your secret key.

We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
...+++++
..+++++
gpg: /Users/akagi201/.gnupg/trustdb.gpg: trustdb created
gpg: key BAD7F7A3 marked as ultimately trusted
public and secret key created and signed.

gpg: checking the trustdb
gpg: 3 marginal(s) needed, 1 complete(s) needed, PGP trust model
gpg: depth: 0  valid:   1  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 1u
pub   2048R/BAD7F7A3 2014-05-27
      Key fingerprint = E19A 2B9C B30F 8D0E 3F14  8C9F 7BAA 088C BAD7 F7A3
uid                  Akagi201 (Bob Liu) &lt;akagi201@gmail.com&gt;

Note that this key cannot be used for encryption.  You may want to use
the command &quot;--edit-key&quot; to generate a subkey for this purpose.
</code></pre>

<p>建议选(3)或者(4)(我选了4), 产生只用来签章的key, 并将有效时间设定为永远. 在产生签章用途的key之后, 该key会存在keyring里, 通常是home目录下的.gnupg 子目录, 你能用gpg列出目前存在的key.</p>

<pre><code>akagi201@akrmbp ~ $ gpg --list-keys
/Users/akagi201/.gnupg/pubring.gpg
----------------------------------
pub   2048R/BAD7F7A3 2014-05-27
uid                  Akagi201 (Bob Liu) &lt;akagi201@gmail.com&gt;

akagi201@akrmbp ~ $ gpg --list-secret-keys
/Users/akagi201/.gnupg/secring.gpg
----------------------------------
sec   2048R/BAD7F7A3 2014-05-27
uid                  Akagi201 (Bob Liu) &lt;akagi201@gmail.com&gt;
</code></pre>

<p>这列出你有一把PGP的Public Key, 接着列出你有一把Secret Key. 这两把key的ID都是0xBAD7F7A3(第二栏, 斜线后), 代表他们是同一对key. Secret Key是使用者收藏(前面有sec字样), 不能让别人知道的部分, 用在签名用途. 而public key则是公开给别人知道(pub字样), 用来验证你的签名.</p>

<p>接着我们要产生加密用途的key.</p>

<pre><code>akagi201@akrmbp ~ $ gpg --edit-key BAD7F7A3
gpg (GnuPG) 1.4.16; Copyright (C) 2013 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Secret key is available.

pub  2048R/BAD7F7A3  created: 2014-05-27  expires: never       usage: SC
                     trust: ultimate      validity: ultimate
[ultimate] (1). Akagi201 (Bob Liu) &lt;akagi201@gmail.com&gt;

gpg&gt; addkey
Key is protected.

You need a passphrase to unlock the secret key for
user: &quot;Akagi201 (Bob Liu) &lt;akagi201@gmail.com&gt;&quot;
2048-bit RSA key, ID BAD7F7A3, created 2014-05-27

Please select what kind of key you want:
   (3) DSA (sign only)
   (4) RSA (sign only)
   (5) Elgamal (encrypt only)
   (6) RSA (encrypt only)
Your selection? 6
RSA keys may be between 1024 and 4096 bits long.
What keysize do you want? (2048)
Requested keysize is 2048 bits
Please specify how long the key should be valid.
         0 = key does not expire
      &lt;n&gt;  = key expires in n days
      &lt;n&gt;w = key expires in n weeks
      &lt;n&gt;m = key expires in n months
      &lt;n&gt;y = key expires in n years
Key is valid for? (0) 2y
Key expires at Thu May 26 10:59:08 2016 CST
Is this correct? (y/N) y
Really create? (y/N) y
We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
..+++++
.+++++

pub  2048R/BAD7F7A3  created: 2014-05-27  expires: never       usage: SC
                     trust: ultimate      validity: ultimate
sub  2048R/6E980A59  created: 2014-05-27  expires: 2016-05-26  usage: E
[ultimate] (1). Akagi201 (Bob Liu) &lt;akagi201@gmail.com&gt;

gpg&gt; quit
Save changes? (y/N) y
</code></pre>

<p>请选择(5)或(6)(这里我选择了6), 产生专用来加密用的public key. 这里将有效时间设为两年(2y), 可依据需要设定. 完成之后, 会看到一把subkey(前面有sub字样), 这里得到的key ID为0x6E980A59. 0x6E980A59为0xBAD7F7A3的subkey. 0x6E980A59的有效期限为2年, 因此, 两年之后你必须生成一把新的key, 以取代这把.</p>

<pre><code>kagi201@akrmbp ~ $ gpg --list-sigs
/Users/akagi201/.gnupg/pubring.gpg
----------------------------------
pub   2048R/BAD7F7A3 2014-05-27
uid                  Akagi201 (Bob Liu) &lt;akagi201@gmail.com&gt;
sig 3        BAD7F7A3 2014-05-27  Akagi201 (Bob Liu) &lt;akagi201@gmail.com&gt;
sub   2048R/6E980A59 2014-05-27 [expires: 2016-05-26]
sig          BAD7F7A3 2014-05-27  Akagi201 (Bob Liu) &lt;akagi201@gmail.com&gt;
</code></pre>

<p>这里可以看到, 0xBAD7F7A3和0x6E980A59这两把key都用0xBAD7F7A3这把key签章过(前面有sig字样). 也就是0xBAD7F7A3 有一个self-sign, 自已签自己.</p>

<pre><code>akagi201@akrmbp ~ $ gpg --armor --export BAD7F7A3
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v1

mQENBFOD/ZQBCADQNTAV2KI+37d/Ep1ginwR2AoMTPe4AbhGVBr5LJsWbrW/y/Ap
Fyar6eAcT2OLAASpAyJNZpGxrG5QmKRjvcC/Bdx4mudWExs1o3aUwGIeCCUBVBdj
r0g2kZji/UbuaArRWVBotl/DIqvYswKM762FnQoOKTlMlj45U1dY1WS2ZP8KFhHV
5RWqJknY8p42QC5Tl09m7TCxkAz7ms+qU8Ya6Af4vLdSo8V7bpbATD2BQtPTpfZt
3z9rezvDRcsWK4O3Cmx5z+Q6HjQZV7Wbg2L3Q0yUzHktMM997WmRlT3zyUYXeAxG
wZSAGKcVd4gvHOLiRB5GyuYr8lIQH0GN/uCzABEBAAG0J0FrYWdpMjAxIChCb2Ig
TGl1KSA8YWthZ2kyMDFAZ21haWwuY29tPokBOAQTAQIAIgUCU4P9lAIbAwYLCQgH
AwIGFQgCCQoLBBYCAwECHgECF4AACgkQe6oIjLrX96OgqggAr21OZvGgqwo59G7H
9QGjwVD5OliJgAUuykEuzCv4ATKm+7Y/g/HgGUqIILKzknOPCe2VGTs+6RA98zWk
9nbdCUEu7oUZTBYq5h1uuPkm4FoJyyrwatSNChqJ4qav6jpZDqGnHwNeEwdY1WNG
uoC+MDM38u5KET6TnqYgmd5B0HWlUuiUx57uKE70vPRpziNDloeLzKdfD0fibKHN
ZFOgJJZkoPhr/yigqmQEfdrajTY4YGEy/2HYIULZYQs0paRe0SVw0UqbDZanOvlr
KOv6XFtH66DjY0pTgUWUXfGylzJAAtgQXQOFDXURC2oYG9DRkvA8q5gaZpqJT4f9
3Awk0bkBDQRTg/98AQgAwTKF9C/72yRmtTVaLziH93eKSc8jKOPt+Ncio5l+Bdhj
lJqJLzQWBB8uRa76wcTKMUpPMOPAMYqZjMekbVIrKFfNHh3pD+y90M/rDkhM2M4Z
gV6XtHnjqhQ4woqejM6k1ADKgndZNoau0TlJ7TagPM33Nay43vHo/BPcx6rs4Ssa
oSnv0sf4PBJeDfhjna+LVAQ18/rPBRijL/Xh6Bn2PWTrmF59g2mmdzV3WMOMsC+I
VkuXP20Vg4B0hFi6t9Hx/B5JL9t/xEEo2YKRyia8F4vtraSlhbMwVnfPfWuG5YSh
AsBa1ByLxCbNdELoLwU69ZDmgFH2x8JdUcm2vslwLwARAQABiQElBBgBAgAPBQJT
g/98AhsMBQkDwmcAAAoJEHuqCIy61/ejD9MH/A3vij2gjaLl3u1CAQB6n8DUSiyr
+bzEkoLHcJDYAM49oM3GPnkCSLJVM7EYmnlR6GOO4PwXlr2GjoxIer+MDCJ8hq98
n+H/2kgV8me/DDSoI1WUiIrcVLBcvylqZv3UWN4Vz+hP48iS/CEtPO6up/l3UAL3
YMWpi96+pnPodjMXL8JcIHlvx8Syxz1J0REI1J7uiGqzvJ9wu4ASYAHtJgi3qsvS
0FvAJcbdWMRNs51Pi0C1SYeztV7yRih8lTjI9ylUoncY5nKPtHrXjCNfpe0fClHx
JLz3WwlAX8gFyM3C+dl/622e7EvK9hO/spn8kS3lHD3q2V3t8GtSM4RzsY4=
=G9Ls
-----END PGP PUBLIC KEY BLOCK-----
</code></pre>

<p>透过上面的指令, 你能将你的public key export出来(导出), 印在纸上, 或存在U盘上, 或者是贴在网路上散布. 然而, 别人如何确定这把key是你的?</p>

<pre><code>akagi201@akrmbp ~ $ gpg --fingerprint
/Users/akagi201/.gnupg/pubring.gpg
----------------------------------
pub   2048R/BAD7F7A3 2014-05-27
      Key fingerprint = E19A 2B9C B30F 8D0E 3F14  8C9F 7BAA 088C BAD7 F7A3
uid                  Akagi201 (Bob Liu) &lt;akagi201@gmail.com&gt;
sub   2048R/6E980A59 2014-05-27 [expires: 2016-05-26]
</code></pre>

<p>上面指令能列出你的public key的fingerprint(指纹)印出来, 这相当于public key浓缩之后的特征(digest). 因此, 其它使用者只需比对这组fingerprint是否和public key的相符, 就能确定这把key的正确性. 因此, 通常你会把fingerprint 印在纸上, 面对面交给对方. 必要时, 还会检查对方的身份证, 护照或其它身份证明文件.</p>

<h2 id="toc_4">交换key</h2>

<p>在开始交换key之前, 建议先把你的public key上传到key server, 别人只需从key server上下载你的key. key server 是由第三方所维护的, 只负责key的散布, 而不负责签名, 因此不会有前面所述伪造的问题.</p>

<p>如下, 上传 0xBAD7F7A3这把key.(注意, 这里需要把shell的http代理关掉,否则上传失败) 上传完之后可以到<a href="http://keys.gnupg.net/">http://keys.gnupg.net/</a>查询.</p>

<pre><code>akagi201@akrmbp ~ $ gpg --send-keys BAD7F7A3
gpg: sending key BAD7F7A3 to hkp server keys.gnupg.net
</code></pre>

<p>之后, 你只需告诉别人你的key id和fingerprint, 其它使用者就能下载和验证完整的public key.</p>

<pre><code>akagi201@akrmbp ~ $ gpg --recv-keys BAD7F7A3
gpg: requesting key BAD7F7A3 from hkp server keys.gnupg.net
gpg: key BAD7F7A3: &quot;Akagi201 (Bob Liu) &lt;akagi201@gmail.com&gt;&quot; not changed
gpg: Total number processed: 1
gpg:              unchanged: 1
akagi201@akrmbp ~ $ gpg --fingerprint
/Users/akagi201/.gnupg/pubring.gpg
----------------------------------
pub   2048R/BAD7F7A3 2014-05-27
      Key fingerprint = E19A 2B9C B30F 8D0E 3F14  8C9F 7BAA 088C BAD7 F7A3
uid                  Akagi201 (Bob Liu) &lt;akagi201@gmail.com&gt;
sub   2048R/6E980A59 2014-05-27 [expires: 2016-05-26]
</code></pre>

<p>例如, 本人的key ID是 0xBAD7F7A3. User ID为&rdquo;Akagi201 (Bob Liu)&ldquo;(前有uid字样). 你可以透过上面的指令下载我的 public key, 并验证fingerprint.</p>

<p>在下载和验证完成别人的public key之后, 若对方是你信任的人, 你可以为他的key签名. 当你为别人的key签名之后, 对方可以分布你的签名, 加强他的public key的可信度, 于是认识你的朋友, 可以依据你的签名, 决定是否相信该public key. 你也可以依据朋友的签名, 决定是否相信其它人的 public key.(下面的例子中我自己没法再给我自己签名了)</p>

<pre><code>akagi201@akrmbp ~ $ gpg --sign-key BAD7F7A3

pub  2048R/BAD7F7A3  created: 2014-05-27  expires: never       usage: SC
                     trust: ultimate      validity: ultimate
sub  2048R/6E980A59  created: 2014-05-27  expires: 2016-05-26  usage: E
[ultimate] (1). Akagi201 (Bob Liu) &lt;akagi201@gmail.com&gt;

&quot;Akagi201 (Bob Liu) &lt;akagi201@gmail.com&gt;&quot; was already signed by key BAD7F7A3
Nothing to sign with key BAD7F7A3

Key not changed so no update needed.
</code></pre>

<p>上面的指令将使用你的secret key, 为 0xBAD7F7A3这把public key签章. 签完之后, 就可以看到0xBAD7F7A3这把key 多了一个签名. 你能将这个签名后的public key(再次)上传到key server, 或export成档案散布. 通常该public key 的原拥有者, 会希望取得你的签名.</p>

<pre><code>akagi201@akrmbp ~ $ gpg --list-sigs
/Users/akagi201/.gnupg/pubring.gpg
----------------------------------
pub   2048R/BAD7F7A3 2014-05-27
uid                  Akagi201 (Bob Liu) &lt;akagi201@gmail.com&gt;
sig 3        BAD7F7A3 2014-05-27  Akagi201 (Bob Liu) &lt;akagi201@gmail.com&gt;
sub   2048R/6E980A59 2014-05-27 [expires: 2016-05-26]
sig          BAD7F7A3 2014-05-27  Akagi201 (Bob Liu) &lt;akagi201@gmail.com&gt;
</code></pre>

<h2 id="toc_5">加密</h2>

<p>当你想要传送机密资料给其它人时, 可使用对方的public key为信件和资料加密. 只有对应的secret key, 才能解开该份信件或资料.</p>

<pre><code>akagi201@akrmbp ~ $ gpg --armor --encrypt --output akmsg.asc akmsg.txt
You did not specify a user ID. (you may use &quot;-r&quot;)

Current recipients:

Enter the user ID.  End with an empty line: Akagi201

Current recipients:
2048R/6E980A59 2014-05-27 &quot;Akagi201 (Bob Liu) &lt;akagi201@gmail.com&gt;&quot;

Enter the user ID.  End with an empty line:
akagi201@akrmbp ~ $ cat akmsg.asc
-----BEGIN PGP MESSAGE-----
Version: GnuPG v1

hQEMA4V0fiJumApZAQgAq5In+b2OiG7ruCfhbycUEUKgSTGrcSdErFuWHbWKpcSj
xItKaJX6s5FGGG01p4Q9h/kYzhOzwnxHmMDFszzcW9cxBSPXES5qpGJd5lO0PTCX
t7yma4geYmFG1zajkJzsnVyJl4NTvfnMgRcAKRqD5QZuo6vQNaURGsDtwcqY/iRt
6wD958HnBr3+OGkP6KCsjbhYsOrIaVnnfF0TEK0cxyCgu2743O8F9rwhwwTVBCMU
qHRXaHjRaGysflcnXlqHVRbHFYKTg+Mo2K2avricTKzu/bdV6J1jeCkqfXrbGKqD
aDxCmYZH1y7JmBNJJhYaWlth0b3Ir26+kO/RSOji2NJRAcJ1/bZK6uROY1LeuMps
G0zdH0ODNvV/sAe+9C23CqGFXrN/z4XdEHR1WyU3ZWUrPnEP4Z1hkQ2zy8ncy32I
92E6SyWit6R7KNbhHu8/A7jt
=F1tG
-----END PGP MESSAGE-----
akagi201@akrmbp ~ $ cat akmsg.txt
This is secret
</code></pre>

<p>例如上面的指令, 使用0x6E980A59这把key(0xBAD7F7A3的subkey), 将akmsg.txt这份文件加密, 并存成akmsg.asc. 上面指令中, 只需输入对方的email address或者user ID(uid), 就会从你的keyring中, 找出对方用来加密的public key.</p>

<h2 id="toc_6">解密</h2>

<p>在你收到加密的文件时, 只需使用下面指令就可以使用存在keyring里的secret key, 为文件解密.</p>

<pre><code>akagi201@akrmbp ~ $ rm akmsg.txt
akagi201@akrmbp ~ $ gpg --decrypt --output akmsg.txt akmsg.asc

You need a passphrase to unlock the secret key for
user: &quot;Akagi201 (Bob Liu) &lt;akagi201@gmail.com&gt;&quot;
2048-bit RSA key, ID 6E980A59, created 2014-05-27 (main key ID BAD7F7A3)

gpg: encrypted with 2048-bit RSA key, ID 6E980A59, created 2014-05-27
      &quot;Akagi201 (Bob Liu) &lt;akagi201@gmail.com&gt;&quot;
akagi201@akrmbp ~ $ cat akmsg.txt
This is secret
</code></pre>

<h2 id="toc_7">提醒</h2>

<p>虽然可能性不是那么高, 但你永远不知道哪一天会需要这样的科技, 以保障你的通讯安全. 若不从现在开始建立你的web of trust, 需要时, 可能为时已晚. 请妥善保管你的secret key, 别让任何人有机可趁. 保护自己, 也保护朋友.</p>

<h2 id="toc_8">Refs</h2>

<ul>
<li><a href="http://www.codemud.net/~thinker/GinGin_CGI.py/show_id_doc/478">http://www.codemud.net/~thinker/GinGin_CGI.py/show_id_doc/478</a></li>
</ul>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://akagi201.github.io/blog/mov-vs-ldr/">
        ARM汇编:MOV, LDR, LDR伪指令之间区别
      </a>
    </h1>

    <span class="post-date">Wed, Mar 19, 2014</span>

    

<p>在编译ARM汇编时, 用MOV指令编译有时会出错, 但是, 有时又对了, 还有LDR, 有时要加个&rdquo;=&ldquo;, 有时又不加了, 非常容易搞混.</p>

<h2 id="toc_0">1. &ldquo;8位图&rdquo;数据</h2>

<p><img src="http://akagi201.qiniudn.com/8bit.jpg" alt="8bit" />
</p>

<h2 id="toc_1">2. MOV指令</h2>

<p>MOV指令可以把立即数或者寄存器内容(注意: 这里绝对不可以是内存!!)传递给一个寄存器.
对于立即数是有要求的, 就是上边的&rdquo;8位图&rdquo;数据. 只能由一个8bit连续有效位通过偶数次移位得到的数.
它为什么会有这样的限制呢?
原因是, MOV本身就是一个32bit指令, 除了指令码本身, 他不可能再带一个可以表示32bit的数字, 所以用了其中的12bit来表示立即数, 其中4bit表示移位的尾数(循环右移, 且数值*2), 8bit用来表示要移位的一个基数.
如果立即数超过这个范围, 就没有办法用一条MOV指令给寄存器赋值(这里就要用到LDR伪指令了, 查看反汇编指令, 你会看到LDR伪指令此变成了两条指令~~).</p>

<h2 id="toc_2">3. LDR指令</h2>

<p>首先呢, ldr指令既可以是大范围的地址读取伪指令, 也可以内存访问指令. 当它的第二个参数前面有&rdquo;=&ldquo;时, 表示伪指令, 否则表示内存访问指令.
LDR指令就是个单寄存器存储的ARM存储器访问指令, 补充了MOV指令不能访问内存的缺陷.
ARM是RISC结构的, 数据从内存到CPU之间的移动只能通过ldr/str指令(我说的是单个寄存器~~).
想要把数据从内存中某处读取到寄存器中, 只能用ldr.</p>

<h2 id="toc_3">4. LDR伪指令</h2>

<ol>
<li><p>LDR伪指令没有立即数范围的限制, 即可以直接赋值, 因为这是一条伪指令.
如果立即数在MOV的要求内, 系统会自动用一条汇编MOV指令来实现. 如果不在MOV的范围内, 就用其它的方式来实现, 比如变成了两条指令, 或者从PC偏移地址读取一个32位的数据给寄存器.</p></li>

<li><p>关于LDR伪指令, 可以装载一个32bit立即数的说法并不正确, 因为在实际中并不是这一条语句装载了32bit立即数(跟上面的貌似一样, 呵呵~~), 比如:</p></li>
</ol>

<p><code>ldr r1,=0x70000000</code></p>

<p>其实真正的汇编代码是将某个地址的值传递给r1, 就是说需要一个地址存放0x70000000这个立即数, 在反汇编中,
如果仔细看会发现, 如果这个立即数可以用mov指令的表达形式来表达, 编译器就直接用mov了.</p>

<h2 id="toc_4">Refs</h2>

<ul>
<li><a href="http://blog.sina.com.cn/s/blog_7ec8fc2c01014epa.html">http://blog.sina.com.cn/s/blog_7ec8fc2c01014epa.html</a></li>
</ul>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://akagi201.github.io/blog/experience-design/">
        体验设计
      </a>
    </h1>

    <span class="post-date">Sun, Mar 16, 2014</span>

    

<p><img src="http://akagi201.qiniudn.com/active-point.png" alt="active-point" />
</p>

<p>受皓玥学姐的邀请, 酱油了一下bong openday的hackathon, 这不是第一次参加hackathon了, 不过算是第一次实际参与了吧. 虽说, 线上的形式会有点松懈没那么多的竞争的感觉.</p>

<h2 id="toc_0">收获</h2>

<ul>
<li>认识了几个小伙伴, 还认识了2个岑徐媛, 咳咳.</li>
<li>快速体验了一个开源免费的原型设计工具 pencil, 还是有点略难用, 收费软件应该用起来更加直观.</li>
<li>也算给学姐帮了点小忙吧, 呵呵.</li>
</ul>

<h2 id="toc_1">成果物仓库</h2>

<ul>
<li><a href="https://github.com/Akagi201/bongOpenPlatform">https://github.com/Akagi201/bongOpenPlatform</a></li>
</ul>

<p><a href="https://www.mindmup.com/map/a15b8effe08f1a01313190068bb1d1db91" data-role="mindmup-embed" title="bong - openday" data-width="90%" data-height="500" data-style="border:1px solid black;margin-bottom:5px;">bong - openday on MindMup</a>
<script async src="https://www.mindmup.com/external-embed.js"></script></p>

<h2 id="toc_2">潘小木的作品</h2>

<ul>
<li>
<img src="http://akagi201.qiniudn.com/bong-open.jpg" alt="bong-open" /></li>
<li>
<img src="http://akagi201.qiniudn.com/%E6%B1%87%E6%80%BB%E6%97%B6%E5%85%89%E6%9C%BA.jpg" alt="汇总时光机" /></li>
</ul>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://akagi201.github.io/blog/learning-embedded-system-note/">
        Learning Embedded System Note
      </a>
    </h1>

    <span class="post-date">Sun, Mar 9, 2014</span>

    

<p><img src="http://akagi201.qiniudn.com/sundy-androidlowlevel.png" alt="sundy-androidlowlevel" />
</p>

<p>换工作这几个月的时间, 还是挺爽的, 时间完全自由支配. 把之前因为工作比较忙的原因没空学习的东西都恶补了一下, 这几个月太赞了, 积累了不少资源, 把openwrt玩遍了, 将ARM-linux嵌入式完整的学习了一遍, 并用思维导图做了笔记.</p>

<h2 id="toc_0">精华部分</h2>

<ul>
<li>应用层所有的东西包括系统调用, C库, pthread库, socket等等全都在glibc的官方文档里面了<a href="http://www.gnu.org/software/libc/manual/">http://www.gnu.org/software/libc/manual/</a>.</li>
<li>很多东西linux和android是相通的, 很多android的东西已经融入到了底层驱动中. 所以, 小米有android的深厚技术基础来发展linux, 相当easy.</li>
<li>思维导图是个好东西, 用来索引记忆还是不错的. 长篇大论还是去别的地方找好了, 没必要记录太多东西.</li>
<li>ARM交叉编译工具链下载地址 <a href="http://www.linaro.org/">http://www.linaro.org/</a></li>
</ul>

<h2 id="toc_1">RTC驱动框图</h2>

<p>学习了一种工具画流程图工具.</p>

<iframe id="embed_dom" name="embed_dom" frameborder="0" style="border:1px solid #000;display:block;width:430px; height:320px;" src="http://www.processon.com/embed/532d8ae60cf253b242881338"></iframe>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://akagi201.github.io/blog/keep-gitting-my-cv-with-markdown/">
        Keep Gitting My CV With Markdown
      </a>
    </h1>

    <span class="post-date">Fri, Sep 27, 2013</span>

    

<ul>
<li>我还是决定一点一点的写吧, 自己的拖延症太厉害了.</li>
<li>Github是个好东西, 现在好玩的东西也越来越多. 其实一个程序员的Github账号就是一份很好的简历.(像我们目前的公司不能联网, 我就不多说什么了, 好公司都不会这样)</li>
<li>Github的<a href="https://github.com/github/markup">markup</a>是个优秀的渲染引擎, 支持markdown等标记语言. 而且, Github还带了简洁大气的css渲染. 也就是说, 直接把简历写成.rst或者.md放在Github上吧!</li>
</ul>

<h2 id="toc_0">My CV online version</h2>

<p><a href="http://cv.akagi201.org">http://cv.akagi201.org</a></p>

<h2 id="toc_1">招聘网站</h2>

<ul>
<li><a href="http://xjh.haitou.cc/">海投宣讲会查询系统</a></li>
</ul>

<h2 id="toc_2">TODO</h2>

<ol>
<li>pdf version</li>
<li>latex modern cv version</li>
<li>简历: 海投, v2ex, 内推, linkedin</li>
</ol>

<h2 id="toc_3">Refs</h2>

<ul>
<li><a href="http://code6.github.io/blog/2013/04/15/keep-updating-your-cv/">http://code6.github.io/blog/2013/04/15/keep-updating-your-cv/</a></li>
<li><a href="https://github.com/hit9/resume.pdf/blob/master/resume.md">https://github.com/hit9/resume.pdf/blob/master/resume.md</a></li>
<li><a href="http://the5fire.com/a-good-resume.html">http://the5fire.com/a-good-resume.html</a></li>
<li><a href="http://resume.linkedinlabs.com">http://resume.linkedinlabs.com</a></li>
<li><a href="http://liresume.blogspot.com/2010/12/pro-tip-format-your-resume-using.html">http://liresume.blogspot.com/2010/12/pro-tip-format-your-resume-using.html</a></li>
<li><a href="http://jianlidachu.com/">http://jianlidachu.com/</a></li>
<li><a href="http://aadps.net/2013/342.html">http://aadps.net/2013/342.html</a></li>
<li><a href="https://gist.github.com/ZhouMeichen/6697329">https://gist.github.com/ZhouMeichen/6697329</a></li>
<li><a href="https://github.com/swachian/new-octopress/blob/master/source/_posts/2012-04-17-gimli-and-markdown-2-pdf.markdown">https://github.com/swachian/new-octopress/blob/master/source/_posts/2012-04-17-gimli-and-markdown-2-pdf.markdown</a></li>
</ul>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://akagi201.github.io/blog/fitbit-flex/">
        Fitbit Flex
      </a>
    </h1>

    <span class="post-date">Tue, Sep 17, 2013</span>

    

<ul>
<li><p>排斥英文的小伙伴们可以不用看了, 各种数据, 各种软件全是英文的.</p>

<h2 id="toc_0">clients</h2></li>

<li><p>pc: <a href="http://www.fitbit.com/setup">http://www.fitbit.com/setup</a> 下载安装 FitbitConnect, 貌似只有2个功能: 同步和升级固件.第一次使用会搜索设备, 然后搜到之后, 双击一下手环表示确认, 我勒个去, 太有科技感了.看配置信息(dashboard)会跳转到网页.</p></li>

<li><p>Android: 只能看数据, 同步目前需要蓝牙4.0, wifi现在还不支持, 看fitbit的开发博客貌似正在beta阶段.</p></li>
</ul>

<h2 id="toc_1">update firmware</h2>

<ul>
<li>通过pc端可以升级, 刚入手时候是50, 升级后变成64了. 具体多了哪些功能还不清楚, 总之越新越好. 升级过程有点慢, 手都不敢动, 很怕升级失败的说.</li>
</ul>

<h2 id="toc_2">Specs</h2>

<ul>
<li>5个白点LED灯，一个蓝牙芯片，一个三轴加速度传感器，一个振动马达，还有一个主控芯片，微小的电池续航能力竟能达到5-7天。还有一块NFC标签, 用于支持NFC的手机同步的.</li>
<li>五个LED灯是跟天线套在一个塑料壳上，有一层黑色胶布把它、电池和整块电路板绑在一起，合得比较紧密.</li>
<li>蓝牙芯片使用的是Nordic的NRF8001.</li>
<li>接下来有两片不明的芯片写有“NXE”和“NAI”字样，其中NAI芯片上还带有疑似二维码的信息.</li>
<li>主控芯片用的是意法半导体的STM32L。电池容量未标清，目测可能是20mAh左右.</li>
</ul>

<h2 id="toc_3">关于卡路里消耗的精度问题</h2>

<ul>
<li>由于fitbit有庞大的数据库源，只要你输入了精确的身高+体重，fitbit就能基本了解你的步长和单步消耗卡路里的平均值，之后这些数据都会很准。</li>
<li>所以初次使用，建议录入自己的精确身高和体重，以后记得更新体重的变化，这样会让数据更准。</li>
</ul>

<h2 id="toc_4">睡眠跟踪</h2>

<ul>
<li>睡前 拍打4-5下触发睡眠跟踪模式，早上醒来再同样操作即可。 在刚躺下的时候记得猛拍它，进入睡眠模式，这样早晨sync一下就能以图表的形式看到昨晚睡眠情况，中途醒了几次，深度睡眠浅度睡眠分别占了多少。我觉得一天几个小时就差不多了，再多真是挥霍生命。</li>
</ul>

<h2 id="toc_5">充电</h2>

<ul>
<li>大概半小时就能冲到8成以上，但是足足充满需要两三小时的，充满电五颗LED会同时闪烁.</li>
</ul>

<h2 id="toc_6">操作</h2>

<ul>
<li>没有任何可见的按钮，平时的操作是靠快速点击：啪啪两下，显示今日目标完成情况，5颗LED各代表20%完成度。。如果猛烈的啪啪啪啪啪点了好多下，就会进入睡眠模式，最左和最右两颗LED亮，再一次啪啪啪啪啪就会切回普通计步模式。而且LED绝大部分时候也是不会亮的，据说运动量达到了设定的目标会有震动和”happy dancing”</li>
</ul>

<h2 id="toc_7">Refs</h2>

<ul>
<li><a href="http://www.leiphone.com/chaijie-fitbit-flex.html">http://www.leiphone.com/chaijie-fitbit-flex.html</a></li>
<li><a href="https://help.fitbit.com/customer/portal/articles/798019">https://help.fitbit.com/customer/portal/articles/798019</a></li>
<li><a href="http://tech2ipo.com/59590">http://tech2ipo.com/59590</a></li>
<li><a href="http://knewone.com/things/fitbit-flex/reviews/51af49127373c295b700001c">http://knewone.com/things/fitbit-flex/reviews/51af49127373c295b700001c</a></li>
<li><a href="https://zlz.im/fitbit-flex-review/">https://zlz.im/fitbit-flex-review/</a></li>
<li><a href="http://www.fitbit.com/group/229BXW">Fitbit 官方中文小组</a></li>
<li><a href="http://dev.fitbit.com/">Fitbit API</a></li>
<li><a href="http://www.douban.com/group/fitbit/">Fitbit 豆瓣小组</a></li>
</ul>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://akagi201.github.io/blog/compile-debian-kernel/">
        Compile Debian Kernel
      </a>
    </h1>

    <span class="post-date">Mon, May 20, 2013</span>

    

<p><img src="http://upload.wikimedia.org/wikipedia/commons/0/04/Debian_logo.png" alt="Debian Logo" />
</p>

<h2 id="toc_0">Changes to the pristine kernel source(原始的kernel source, www.kernel.org)</h2>

<ul>
<li>pristine kernel source == upstream kernel source</li>
<li>由于 licensing restrictions, unclear license information, failure to comply with the Debian Free Software Guidelines (DFSG), 部分的kernel被移除为了发布Debian archive的 main section(the source in the main section of the Debian archive). 这种搬移工具产生了 linux_version.orig.tar.xz tarball, 作为原始的上流源码(original upstream source). version是实际的upstream version.</li>
<li>在2.6.31-1以后的版本中, 所有的已知的没有源码的firmware已经被从Debian package中移除了, 但是他们大多被包含在 firmware-nonfree package中.</li>
<li>Reference:</li>
<li><a href="http://www.debian.org/vote/2006/vote_007">Handling source-less firmware in the Linux kernel</a></li>
<li><a href="http://lists.debian.org/debian-kernel/2006/10/msg00541.html">position statement</a></li>
<li><a href="http://wiki.debian.org/KernelFirmwareLicensing">KernelFirmwareLicensing</a></li>
</ul>

<h2 id="toc_1">Debian kernel patches</h2>

<ul>
<li>Debian kernel的源码: linux_version.orig.tar.xz(去掉license不合格的firmware) + Debian patches</li>
<li>Debian patches: 必要的修复严重bug fixes 和 安全漏洞(security holes)</li>
<li>Debian version of the kernel packages: version-revision(version: upstream kernel version, revision: patchlevel)</li>
<li>接受patch的原则: fix a bug or add hardware support.</li>
<li>patches introducing optional features 推荐提交到 upstream maintainer.</li>
</ul>

<h2 id="toc_2">Refs</h2>

<ol>
<li>一直保持最新的文档 <a href="http://kernel-handbook.alioth.debian.org">Debian Linux Kernel Handbook</a></li>
</ol>

  </div>
  
</div>
</div>

  </body>
</html>
